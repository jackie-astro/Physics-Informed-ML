Estimating Treatment Effects from Irregular Time Series Observations with Hidden Confounders

Author: Defu Cao James Enouen Yujing Wang Xiangchen Song Chuizheng Meng Hao Niu Yan Liu


## Challenges:

1. Existence of hidden confounders can lead to biased treatment estimates and complicate the causal inference process
2. In continuous time settings with irregular samples, it is challenging to directly handle the dynamics of causality


## Previous Related Works and their Limitations:

### Previous works

1. "Necessary and sufficient conditions for causal feature selection in time series with latent common causes" Study the identification of direct and indirect causes for causal feature selection in time series solely based on observational data
2. Deconfounding-based models use latent variables given by their factor model as substitutes for the hidden confounders to render the assigned treatments conditionally independent.
   (Time series deconfounder: Estimating treatment effects over time in the presence of hidden confounders.
    Sequential Deconfounding for Causal Inference with Unobserved Confounders)

### Limitations

Either cannot handle irregular time series or have strong assumptions. In addition, The range of hidden confounders generated by previous data-driven
works is possibly unjustifiable, which will distort (obscure or augment) the true causal relationship between treatments
and outcomes.

## Summary

LipCDE is proposed to solve the above challenges.

LipCDE = recent advances in Lipschitz regularization + neural controlled differential equations (CDE)

LipCDE can directly model the dynamic causal relationships between historical data and outcomes with irregular samples by considering the boundary of hidden confounders given by Lipschitz constrained neural networks
 
* Related Tasks
1) Treatment effects learning in the static setting
 
2) Treatment effects learning in the dynamic setting without hidden confounders
 
3) Treatment effect learning in the dynamic setting with hidden confounders

## Process

<img width="750" alt="knowledge-aware" src="https://github.com/jqwenchen/PIML/blob/master/paper/imgs/1.png">


LipCDE first infers the interrelationship of hidden confounders on treatment by bounding the boundary of hidden confounders via the hidden confounders boundary branch.

After that, LipCDE feeds the history trajectories into the synthetic control branch, which utilizes both observed data and hidden confounders to generate the latent representation of each patient.

Besides, re-weight the population of all participating patients and balance the representation via applying a time-varying inverse probability of treatment weighting (IPTW) strategy. Then, Combined with the LSTM layer, the outcome model can get the final estimate of the treatment effect.
